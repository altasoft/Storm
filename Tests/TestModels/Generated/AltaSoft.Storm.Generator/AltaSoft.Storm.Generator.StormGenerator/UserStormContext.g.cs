//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by 'AltaSoft Storm ORM Generator'.
//     Changes to this file may cause incorrect behavior and will be lost if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

#nullable enable

using System;
using AltaSoft.Storm.Attributes;
using AltaSoft.Storm.TestModels.VeryBadNamespace;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Data.Common;
using System.Linq;
using System.Linq.Expressions;
using System.Runtime.CompilerServices;
using System.Threading;
using System.Threading.Tasks;
using AltaSoft.Storm;
using AltaSoft.Storm.Crud;
using AltaSoft.Storm.Interfaces;
using AltaSoft.Storm.Exceptions;
using AltaSoft.Storm.Extensions;

// #pragma warning disable IDE1006
// ReSharper disable InconsistentNaming

namespace AltaSoft.Storm.TestModels;

public partial class UserStormContext
{
    /// <summary>
    /// Scalac function executor for <c>.ScalarFunc2</c>
    /// </summary>
    public IExecuteScalarFunc<AltaSoft.Storm.TestModels.VeryBadNamespace.CustomerId> ExecuteScalarFunc(AltaSoft.Storm.TestModels.DomainTypes.UserId userId, int branchId)
    {
        var callParams = new List<StormCallParameter>(2)
        {
            new("@user_id", UnifiedDbType.Int32, userId, 0, 0, 0, ParameterDirection.Input),
            new("@branch_id", UnifiedDbType.Int16, branchId, 0, 0, 0, ParameterDirection.Input)
        };

        return StormCrudFactory.ExecuteScalarFunc<AltaSoft.Storm.TestModels.VeryBadNamespace.CustomerId>(this, callParams, null, "ScalarFunc2", ResultReader);

        static AltaSoft.Storm.TestModels.VeryBadNamespace.CustomerId ResultReader(StormDbDataReader dr) => (AltaSoft.Storm.TestModels.VeryBadNamespace.CustomerId)(long)dr.GetInt32(0);
    }
    /// <summary>
    /// Stored procedure executor for <c>test.InputOutputProc</c>
    /// </summary>
    public IExecuteProc<InputOutputProcResult> ExecuteInputOutputProc(AltaSoft.Storm.TestModels.DomainTypes.UserId? userId, int io)
    {
        var callParams = new List<StormCallParameter>(3)
        {
            new("@user_id", UnifiedDbType.Int32, userId, 0, 0, 0, ParameterDirection.Input),
            new("@result_id", UnifiedDbType.Int32, DBNull.Value, 0, 0, 0, ParameterDirection.Output),
            new("@io", UnifiedDbType.Int32, io, 0, 0, 0, ParameterDirection.InputOutput)
        };

return StormCrudFactory.ExecuteProc<InputOutputProcResult>(this, callParams, "test", "InputOutputProc", ResultReader);

        static InputOutputProcResult ResultReader(int rowsAffected, StormDbParameterCollection parameters, Exception? ex)
        {
            return new InputOutputProcResult()
            {
                RowsAffected = rowsAffected,
                Exception = ex,
                ReturnValue = (int)parameters[0].Value,
                ResultValue = parameters["@result_id"].Value.GetDbValue<int>(),
                Io = parameters["@io"].Value.GetDbValue<int>()
            };
        }
    }

    /// <summary>
    /// Result class for <see cref="ExecuteInputOutputProc"/>
    /// </summary>
    public record InputOutputProcResult : StormProcedureResult
    {
        public int ResultValue { get; set; }
        public int Io { get; set; }
    }

}
